<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Live Stream Player</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
    body {
        margin: 0;
        background: #000;
        font-family: Arial, sans-serif;
    }
    #player {
        width: 100vw;
        height: 100vh;
        background: #000;
    }
</style>
</head>

<body>

<video id="player" controls autoplay playsinline></video>

<!-- FLV.js -->
<script src="https://cdn.jsdelivr.net/npm/flv.js@latest/dist/flv.min.js"></script>

<script>
// Detect Apple devices (iPhone, iPad, iOS Safari)
function isAppleDevice() {
    return /iPhone|iPad|iPod/i.test(navigator.userAgent) ||
           (navigator.vendor && navigator.vendor.includes('Apple')) ||
           (/Safari/.test(navigator.userAgent) && !/Chrome/.test(navigator.userAgent));
}

function startStream() {
    // Your stream URLs
    const flvUrl = "https://streaming.bazytrack.jo/live/0/864993060747947.flv";
    const hlsUrl = "https://streaming.bazytrack.jo/live/0/864993060747947.m3u8";

    const video = document.getElementById("player");

    // If Apple device → force HLS
    if (isAppleDevice()) {
        console.log("Apple device detected → using HLS");
        video.src = hlsUrl;
        video.play();
        return;
    }

    // If browser supports FLV.js → try FLV
    if (flvjs.isSupported()) {
        console.log("FLV.js detected → using FLV WebSocket");
        const flvPlayer = flvjs.createPlayer({
            type: "flv",
            url: flvUrl,
            isLive: true
        });

        flvPlayer.attachMediaElement(video);
        flvPlayer.load();
        flvPlayer.play();

        // Fallback to HLS when FLV fails
        flvPlayer.on(flvjs.Events.ERROR, function (err) {
            console.warn("FLV error detected → switching to HLS", err);
            flvPlayer.unload();
            video.src = hlsUrl;
            video.play();
        });

    } else {
        console.log("FLV not supported → using HLS");
        video.src = hlsUrl;
        video.play();
    }
}

startStream();
</script>

</body>
</html>
